(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[541],{2157:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a,i=n(0),r={height:"100%",display:"flex",flexDirection:"column"},o={width:"440px",minWidth:"none",maxWidth:"none"},s={Modal:{styles:{main:Object(i.__assign)({selectors:(a={},a["@media (min-width: 480px)"]=Object(i.__assign)({},o),a),minHeight:"240px"},o)}},DialogContent:{styles:{content:r,inner:r,innerContent:r}},DialogFooter:{styles:{actions:{minHeight:"none"}}}}},2167:function(e,t,n){"use strict";n.r(t),n.d(t,"ConfirmationDialog",function(){return _});var a=n(1652),i=n(1180),r=n(1785),o=n(584),s=n(1510),c=n(2157),d=n(238),l=n(1789),u=n(1),f=n(1170),p=n(2526),m=d.n.isFeatureEnabled({ODC:"DialogNextEnabled",ODB:60768})?c.e:{},_=function(e){var t=e.onConfirm,n=e.onCancel,c=e.defaultToYes,d=void 0!==c&&c,_=e.defaultFocusToYes,h=void 0!==_&&_,b=e.yesText,g=void 0===b?p.t:b,v=e.noText,y=void 0===v?p.e:v,S=e.yesClassName,D=e.noClassName,I=function(e){e&&e.focus()},x=d?a.e:i.e,C=d?i.e:a.e,O=h?void 0:I,w=h?I:void 0;return u.createElement(f.e,null,u.createElement(l.e,{scopedSettings:m},u.createElement(r.e,{styles:e.styles,dialogContentProps:{type:o.e.close,styles:e.contentStyles,subText:e.prompt?e.prompt:""},onDismiss:n,hidden:!1,title:e.title,maxWidth:e.maxWidth,closeButtonAriaLabel:e.closeButtonAriaLabel},e.children,u.createElement(s.e,null,u.createElement(x,{className:S,"data-automationid":"confirmbutton",onClick:t,componentRef:w},g),u.createElement(C,{className:D,"data-automationid":"cancelbutton",onClick:n,componentRef:O},y)))))}},2312:function(e,t,n){"use strict";n.d(t,"n",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"t",function(){return s});var a=n(18);Object(a.n)([{rawString:".field_937c968c{display:inline-block;box-sizing:border-box;max-width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.field_937c968c.block_937c968c{display:block}.pathSection_937c968c{display:inline;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.pathSection_937c968c{color:WindowText}}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.ms-DetailsRow.is-selected .ms-DetailsRow-cell .pathSection_937c968c{color:HighlightText}}.chevron_937c968c{font-size:12px;margin:3px 1px;transform:scale(.5);vertical-align:middle;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.chevron_937c968c{color:WindowText}}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.ms-DetailsRow.is-selected .ms-DetailsRow-cell .chevron_937c968c{color:HighlightText}}"}]);var i="field_937c968c",r="block_937c968c",o="pathSection_937c968c",s="chevron_937c968c"},2420:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"e",function(){return a});var a,i={applyPanel:"filtersPane-applyInPanel",pinnedToFiltersPaneChanged:"filtersPane-pinnedToFiltersPaneChanged",showInFiltersPaneChanged:"filtersPane-showInFiltersPaneChangedChanged",sectionInfosChanged:"filtersPane-sectionInfosChanged",canvasFilterChanged:"filtersPane-canvasFilterChanged"};function r(e){return e}!function(e){e[e.none=0]="none",e[e.last3Months=1]="last3Months",e[e.last30Days=2]="last30Days",e[e.last7Days=3]="last7Days",e[e.yesterday=4]="yesterday",e[e.today=5]="today",e[e.tomorrow=6]="tomorrow",e[e.next7Days=7]="next7Days",e[e.next30Days=8]="next30Days",e[e.next3Months=9]="next3Months",e[e.nextYear=10]="nextYear"}(a||(a={}))},2461:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(6),i=new a.e("itemPathField",{displayPathSegments:a.t,openUrl:a.t,action:a.t})},2462:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(1),i=n(533),r=n(1792),o=n(228),s=n(43),c=n(2312),d=n(80),l=function(e){var t=e.displayPathSegments,n=e.parentLink,i=e.target,l=e.onClick,p=e.className,m="",_=[];if(t){var h=t.join(" ".concat(d.w," "));m=s.format(d.E,h),_=function(e,t,n){var a=[];if(!e.length)return a;var i=0,r=60,o="â€¦",s=e.map(function(e){return e.trim()}),c=s[0],d=s.length>=2?s[1]:"",l=d?c.length+d.length+3+o.length-r:0,p=s[s.length-1],m=c.length+p.length+2*(3+o.length)-r;if(c.length>r){var _=c.substr(0,59).trim()+o;a.push(u(_,++i,t))}else if(1===e.length||c.length+3+o.length>r||s.length>2&&c.length+2*(3+o.length)>r)a.push(u(c,++i,t));else if(2===s.length&&l>1)a.push(u(c,++i,t)),a.push(f(++i,n)),a.push(u(o+d.substr(l).trim(),++i,t));else if(s.length>2&&m>1){var h=p.substr(m).trim();a.push(u(c,++i,t)),a.push(f(++i,n)),a.push(u(o,++i,t)),h.length>0&&(a.push(f(++i,n)),a.push(u(o+h,++i,t)))}else{var b=0;a.push(u(c,++i,t)),b+=c.length;for(var g=1;g<e.length;++g){a.push(f(++i,n));var v=s[g];a.push(u(v,++i,t)),b+=3+v.length}for(b>r&&(s.splice(1,1),a.splice(2,1,u(o,++i,t)),b-=d.length-o.length);b>r;){var y=s.splice(1,1)[0];a.splice(3,2),b-=y.length+3}}return a}(t)}return l||n?a.createElement(r.e,{dir:"auto",className:Object(o.e)(c.n,p),"aria-label":m,href:n,target:i,onClick:l,title:d.A},_):a.createElement("div",{dir:"auto","aria-label":m,className:Object(o.e)(c.n,p)},_)};function u(e,t,n){return a.createElement("div",{key:t,className:Object(o.e)(c.a,n)},e)}function f(e,t){return a.createElement(i.e,{key:e,className:Object(o.e)(c.t,t),iconName:"ChevronRightSmall"})}},2525:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n(1),i=n(2462),r=n(2312),o=n(7),s=n(24),c=n(327),d=n(268),l=n(174),u=n(9),f=n(2461),p=u.e.isActivated("AB1B9B00-C482-451A-A5DA-500AC7533605","1/31/2022","Require Name to be clickable for parent path to be clickable"),m=[];function _(e,t){var n=t.itemKey,d=t.renderer,u=e.demandItemFacet(o.k,n),_=e.demandItemFacet(o.A,null==u?void 0:u.itemKey)||"",b=e.demandItemFacet(f.e,n),g=f.e.evaluate(b)(e,{itemKey:n,displayPathSegments:_?h(_):m,openUrl:_,action:u&&_?Object(l.a)(e,a.createElement(c.e,{itemKey:u.itemKey})):null}),v=g.displayPathSegments,y=void 0===v?m:v,S=g.action,D=g.openUrl;return{renderer:function(e,t,n){var o=d?d(e,t,n):null;return a.createElement(a.Fragment,null,o?a.createElement(a.Fragment,{key:"content"},o):null,y.length>0?a.createElement(s.n,{key:"path",action:S},function(t){var n=t.execute,o=t.isAvailable&&(p||e.isInvokable)?function(e){n({event:e}).catch(function(){}),e.preventDefault(),e.stopPropagation()}:void 0;return a.createElement(i.e,{className:r.e,displayPathSegments:y,parentLink:o?D:void 0,onClick:o})}):null)}}}function h(e){for(var t=[],n=0,a=new d.e(e).segments.slice(1);n<a.length;n++){var i=a[n];try{t.push(decodeURIComponent(i))}catch(e){t.push(i)}}return t}},2604:function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(0),i=n(262),r=n(97),o=n(1225),s=n(391),c=n(9).t.isActivated("cade488d-480a-444f-a1ea-d3d121529bb7","11/01/2021","Set one minute timeout for API requests");function d(e){var t=this,n=e.itemKey,d=e.itemSetKeyFacet,l=e.getUrl,u=e.sortChildItems,f=e.qosName,p=e.preprocessResponse,m=e.expectedErrors,_=e.disableRemoteItem,h=void 0!==_&&_,b=e.scenarioInfo,g=d.deserialize(n),v=g.driveItemKey,y=v.endpoint,S=v.driveId;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,d,_,v,D,I;return Object(a.__generator)(this,function(x){switch(x.label){case 0:t=Object(i.n)(g.driveItemKey),x.label=1;case 1:return x.trys.push([1,4,,5]),[4,n(Object(r.n)({url:l(g),driveUrl:t,driveId:S,qosName:"getChildren".concat(f?".".concat(f):""),endpoint:y,headers:e.additionalHeaders,expectedErrors:m,timeout:c?void 0:6e4,scenarioInfo:b}))];case 2:return d=x.sent(),_=Object(a.__spreadArray)([],d.value,!0),v=p&&p(_)||d.value,D=u&&u(v)||v,[4,n(Object(o.e)(Object(a.__assign)(Object(a.__assign)({},e),{disableRemoteItem:h,childItemsResponse:Object(a.__assign)(Object(a.__assign)({},d),{value:D})})))];case 3:return[2,{itemResolver:x.sent().itemResolver}];case 4:throw I=x.sent(),new s.e(Object(a.__assign)({code:"UnknownError"},I instanceof Error?{innerError:I}:{message:JSON.stringify(I)}));case 5:return[2]}})})}}},2605:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=n(9).e.isActivated("EB854331-5340-42D0-8893-9E093DC56A47","03/10/2022","Use standard Open command for Office files")},2779:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n(0),i=n(308),r=n(2525),o=n(185),s=n(129),c=n(860),d=n(1238),l=n(1219),u=n(1220),f=n(1204),p=n(359),m=n(9).e.isActivated("A8ABE184-9647-42E8-BBAD-7AC7F51995D6","5/20/2022","Fix signals positioning in nameAndPathColumn")?[f.t,r.e]:[r.e,f.t],_=Object(c.e)({key:o.s,name:i.c,fieldName:"",isCollapsible:!1,minWidth:445,maxWidth:445,sortProps:s.a,data:{facets:Object(a.__assign)({},p.e.pack("nameAndPath"))}},Object(a.__spreadArray)(Object(a.__spreadArray)([d.e],m,!0),[l.e,u.e],!1))},2780:function(e,t,n){"use strict";n.d(t,"n",function(){return o}),n.d(t,"e",function(){return s}),n.d(t,"t",function(){return c});var a=n(2),i=n(530),r=n(953),o=new a.e("removeItemsFromSharedList"),s=new i.e("removeItemsFromSharedList"),c=Object(r.e)({operationTypeFacet:o,progressKeyFacet:s})},3040:function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(675),i=n(22),r=n(159),o=n(334),s=n(259),c=n(117),d=n(0),l=n(632);function u(e,t){var n=t.itemsScopeItemKey,a=t.engagement,i=a&&a.name;return{engagement:{objectType:"SharedWithMe",datasource:"Graph",extraData:Object(d.__assign)({},"ItemsView.Load"===i?Object(l.e)(e,{itemsScopeItemKey:n}):{})}}}function f(e,t){return{engagement:{currentPage:"SharedWithMe"}}}var p=Object(i.t)(function(){return function(e){e(Object(a.e)(c.e,r.e)(u)),e(Object(a.e)(s.e,r.e)(u)),e(Object(a.e)(c.e,o.e)(f))}})},3061:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(3335),i=(a.T,a.l,a.F,a.H,a.U,a.i,a.p,a.L,a.C,a.M,a.P,a.k,a.v,a.E,a.y,a.g,a.I,a._,a.x,a.D,a.S,a.h,a.A,a.w,a.O,a.b,[a.r,a.a,a.c,a.e,a.d,a.s,a.o,a.t,a.m,a.f,a.u,a.n])},3062:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(117),i=n(259),r=n(419),o=n(495),s=n(3040),c=Object(o.e)(a.e,function(e){return function(){return{defaultChildItemSet:{itemKey:i.e.serialize({driveItemKey:e,sortBy:"",isAscending:!0})},displayName:r.s,icon:"People"}}},s.e)},3063:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(6),i=new a.e("removeFromShardListAction",{isAvailable:a.t})},4340:function(e,t,n){"use strict";n.r(t),n.d(t,"graphSharedWithMeWebAddon",function(){return Ht});var a,i=n(22),r=n(321),o=n(358),s=n(1155),c=n(675),d=n(0),l=n(333),u=n(384),f=n(607),p=n(1183),m=n(1284),_=n(36),h=n(2),b=n(1),g=n(617),v=n(1257),y={action:b.createElement(_.t,null,b.createElement(v.t,null)),automationId:"removeShortcutFromSharedWithMeCommand",title:g.p,iconProps:{iconName:"FabricFolderLink"},key:new h.e("RemoveShortcutFromSWM").id,name:g.f},S=n(149),D=n(232),I=n(2167),x=n(953),C=n(2780),O=n(7),w=n(53),E=n(83),A=n(131),L=n(24),k=n(40),M=n(19),P=n(3063),T=n(62),U=n(259),F=n(9),H=Object(w.t)(function(e,t){var n=t.itemKeys,a=t.removeFromSharedListWizard,i=t.removeItemsFromSharedList,r=void 0===i?C.t:i,o=Object(E.e)(e)||"",s=e.demandItemFacet(U.e,o);if(0===n.length)return null;for(var c=s&&n.length<=200,l=a,u=0,f=n;u<f.length;u++){var p=f[u],m=e.demandItemFacet(P.e,p),_=F.t.isActivated("6c28a705-1f14-4f06-97c7-ee39b2d66e9e","11/5/2020","Action should be available unless otherwise stated in control handler");P.e.evaluate(m)(e,{itemKey:p,isAvailable:!_}).isAvailable||(c=!1)}var h=e.dispatch,g=function(){return Object(d.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(d.__generator)(this,function(a){switch(a.label){case 0:return e={itemSetKey:o},t=Object(A.e)(n,function(){return e}),[4,h(r({items:t}))];case 1:return a.sent(),[2]}})})},v=Object(L.o)(function(e){return b.createElement(l,Object(d.__assign)({},e,{onItemRemoved:g,itemKeys:n}))});return b.createElement(k.e,Object(d.__assign)({isAvailable:c,onExecute:v},Object(T.t)(e,{itemKey:void 0,engagement:{name:"RemoveFromSharedList",isIntentional:!0,extraData:{itemCount:n.length}}})))}),R=Object(M.r)()(H),N=n(3693),B=n(3336),j=n(43),V=n(54),z=n(541),G=n(156),K=((a={})[V.a.started]=function(e){return Object(j.formatToArray)(Object(j.getLocalizedCountValue)(B.r,B.t,e)||"",e)},a[V.a.completed]=function(e){return Object(j.formatToArray)(Object(j.getLocalizedCountValue)(B.e,B.t,e)||"",e)},a[V.a.failed]=function(e){return Object(j.formatToArray)(Object(j.getLocalizedCountValue)(B.n,B.a,e)||"",e)},a[V.a.canceled]=function(e){return Object(j.formatToArray)(Object(j.getLocalizedCountValue)(B.n,B.a,e)||"",e)},a),W=Object(i.t)(function(){return function(e){e(Object(c.e)(C.e,z.e)(q))}});function q(e,t){var n,a=Object(G.a)(e,t),i=a.phase,r=a.count;return n=K[i](r),Object(d.__assign)({},n&&"item"!==t.format?{title:n}:{})}var Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(d.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.resolve,a=t.reject,i=t.onItemRemoved,r=t.itemKeys,o=function(){return Object(d.__awaiter)(e,void 0,void 0,function(){return Object(d.__generator)(this,function(e){switch(e.label){case 0:return n(),[4,i()];case 1:return e.sent(),[2]}})})},s=function(){return Object(d.__awaiter)(e,void 0,void 0,function(){return Object(d.__generator)(this,function(e){return a(new S.e),[2]})})};return b.createElement(D.e,null,function(e){var t=e.itemCache,n=Y(t,r),a=n.title,i=n.prompt;return b.createElement(I.ConfirmationDialog,{onCancel:s,onConfirm:o,yesText:B.i,noText:N.o,defaultToYes:!0,title:a,prompt:i})})},t}(b.PureComponent),Y=function(e,t){if(t.length>1)return{title:N.r,prompt:N.i};if(1===t.length){var n=e.demandItemFacet(O._,t[0]);return{title:n?N.a:N.t,prompt:n?N.n:N.e}}return{title:"",prompt:""}},J=Object(x.e)({operationTypeFacet:C.n,progressKeyFacet:C.e,initializeBatch:function(){return W}}),X=Object(w.e)(function(){return{removeFromSharedListWizard:Q,removeItemsFromSharedList:J}})(R),Z={key:n(1350).e,automationId:"removeFromSharedListCommand",name:g.D,action:b.createElement(_.t,null,b.createElement(X,null)),iconProps:{iconName:"Cancel"}},$=n(278),ee=n(1039),te=n(2605),ne=!F.t.isActivated("A62AD86A-B7EB-4EF6-A7F2-CC139D544AE7","",""),ae={name:"-",key:"divider_1",itemType:$.e.Divider};function ie(e,t){return{commands:Object(d.__spreadArray)(Object(d.__spreadArray)(Object(d.__spreadArray)(Object(d.__spreadArray)([te.e?l.e:ee.t,u.n,u.t],ne?[ae]:[],!0),[m.e],!1),ne?[f.e]:[],!0),[y,Z,p.e],!1)}}var re=n(117),oe=!F.t.isActivated("A62AD86A-B7EB-4EF6-A7F2-CC139D544AE7","","");function se(e,t){return{commands:Object(d.__spreadArray)(Object(d.__spreadArray)([te.e?l.e:ee.e,u.n,u.t,m.e],oe?[f.e]:[],!0),[y,Z,p.e],!1)}}var ce,de=n(226),le=n(330),ue=n(185),fe=n(97),pe=((ce={})[ue.a]=!0,ce[ue.n]=!0,ce[ue.s]=!0,ce[le.u]=!0,ce[le.e]=!0,ce[le.d]=!0,ce);function me(e,t){return{isAvailable:!0,sortHandler:function(e,t){var n=t.itemSetKey,a=t.handler,i=a.columnKey,r=a.isAscending;if(!pe[i])return{};var o=e.demandItemFacet(U.e,n);if(!o)return{};var s=le.a[i];if(!s)return{};var c=o.driveItemKey.endpoint,l=o.sortBy;return Object(fe.a)(e,c)&&!l&&i===ue.n&&r?{newItemSetKey:n}:{newItemSetKey:U.e.serialize(Object(d.__assign)(Object(d.__assign)({},o),{sortBy:s,isAscending:r}))}}}}var _e,he=n(415),be=n(525),ge=n(1086);function ve(e,t){var n=t.itemKey,a=e.demandItemFacet(U.e,n),i=a&&a.driveItemKey.endpoint,r=i&&a&&Object(ge.t)(e,{itemSetKey:U.e.serialize(a),parentItemKey:re.e.serialize({endpoint:i}),stageItem:t.stageItem});return Object(d.__assign)({},r?{stageItem:r}:{})}var ye=((_e={})[le.u]=!0,_e[le.e]=!0,_e);function Se(e,t){var n=t.itemSetKey,a=t.handler.columnKey;if(!ye[a])return{};var i=e.demandItemFacet(U.e,n);if(!i)return{};var r=le.a[a];return r?{newItemSetKey:U.e.serialize(Object(d.__assign)(Object(d.__assign)({},i),{groupBy:r}))}:{}}function De(e,t){var n=t.itemSetKey,a=e.demandItemFacet(U.e,n);return a?{newItemSetKey:U.e.serialize(Object(d.__assign)(Object(d.__assign)({},a),{groupBy:void 0}))}:{}}var Ie=n(3062),xe=n(2604),Ce=n(335),Oe=n(1540),we=n(537),Ee=n(1038);function Ae(e,t){var n=new Date(e.valueOf());return n.setDate(n.getDate()-t),n}var Le=n(2420),ke=new Map([["code",Ce.e.text],["csv",Ce.e.excel],["docx",Ce.e.word],["dotx",Ce.e.word],["one",Ce.e.onenote],["onepkg",Ce.e.onenote],["onetoc",Ce.e.onenote],["pdf",Ce.e.pdf],["photo",Ce.e.media],["potx",Ce.e.powerpoint],["ppsx",Ce.e.powerpoint],["pptx",Ce.e.powerpoint],["rtf",Ce.e.text],["txt",Ce.e.text],["video",Ce.e.media],["xlsx",Ce.e.excel],["xltx",Ce.e.excel],["zip",Ce.e.zip]]);function Me(e,t,n){var a=e.lastModifiedDateTime,i=t.lastModifiedDateTime,r=a&&i&&new Date(a).getTime()-new Date(i).getTime()||0,o=a&&i&&new Date(i).getTime()-new Date(a).getTime()||0;return n?r:o}function Pe(e,t,n){var a=e&&e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedDateTime,i=t&&t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedDateTime,r=a&&i&&new Date(a).getTime()-new Date(i).getTime()||0,o=a&&i&&new Date(i).getTime()-new Date(a).getTime()||0;return n?r:o}function Te(e,t,n){var a=e.name,i=t.name,r=a&&i&&a.localeCompare(i)||0,o=a&&i&&i.localeCompare(a)||0;return n?r:o}function Ue(e,t,n){var a,i,r,o,s,c,d=(null===(a=e.remoteItem)||void 0===a?void 0:a.shared)&&(null!==(i=e.remoteItem.shared.sharedBy)&&void 0!==i?i:e.remoteItem.shared.owner),l=null===(r=null==d?void 0:d.user)||void 0===r?void 0:r.displayName,u=(null===(o=t.remoteItem)||void 0===o?void 0:o.shared)&&(null!==(s=t.remoteItem.shared.sharedBy)&&void 0!==s?s:t.remoteItem.shared.owner),f=null===(c=null==u?void 0:u.user)||void 0===c?void 0:c.displayName,p=l&&f&&l.localeCompare(f)||0,m=l&&f&&f.localeCompare(l)||0;return n?p:m}function Fe(e,t,n,a){return function(e,i){return Object(d.__spreadArray)([],e,!0).sort(function(e,i){var r,o,s,c,d=e.folder||(null===(r=e.remoteItem)||void 0===r?void 0:r.folder)||(null===(o=e.remoteItem)||void 0===o?void 0:o.bundle),l=i.folder||(null===(s=i.remoteItem)||void 0===s?void 0:s.folder)||(null===(c=i.remoteItem)||void 0===c?void 0:c.bundle);return n&&d&&!l?-1:n&&!d&&l?1:a(e,i,t)})}(e)}var He=n(51),Re=n(276),Ne=n(10),Be=n(30),je=n(16),Ve=new Be.e("SharedByPersonKeyFacet",{displayName:je.e,email:je.e,id:je.e}),ze=new Be.e("dateSharedGroupKeyFacet",{relativeTime:je.e,sharedDateTime:je.e}),Ge=new Be.e("relativeTimeGroupKeyFacet",{relativeTime:je.e}),Ke=n(379),We=n(71),qe=n(20),Qe=n(3692),Ye=n(824),Je=n(52),Xe=n(3061),Ze=F.t.isActivated("1E74BB9A-47A2-40F6-89FA-C628928BEC2F","04/12/2022","Enable grouping of items that are missing the email or display name of the person who shared an item");var $e=n(873),et=n(714),tt=Object(i.i)()(function e(t){var n=this,a=U.e.deserialize(t.itemKey),i=a.filters,r=a.sortBy,o=a.isAscending;return function(a){return Object(d.__awaiter)(n,void 0,void 0,function(){var n,s,c,l,u,f,p,m,_,h;return Object(d.__generator)(this,function(b){switch(b.label){case 0:return n=function(e){if(U.e.matches(e)){var t=U.e.deserialize(e).groupBy;if(t===le.a[le.u])return function(e){var t={},n=function(a){for(var i,r,o=new Ke.e({publisher:n}),s=function(e){for(var t=[],n=0,a=e;n<a.length;n++){var i=a[n];if(!Ve.matches(i))return e;var r=Ve.deserialize(i);t.push(r)}return t.sort(function(e,t){return e&&t&&e.displayName.localeCompare(t.displayName)}).map(function(e){return Ve.serialize(e)})}(Object.keys(t)),c=[],l=0,u=s;l<u.length;l++){var f=u[l];if(Ve.matches(f)){var p=Ve.deserialize(f);o.resolveItems({items:(i={},i[f]=Object(d.__assign)(Object(d.__assign)(Object(d.__assign)({},O.u.pack(p.displayName)),We.r.pack(!0)),qe.e.pack({itemKeys:t[f]})),i)}),c.push(f)}}return o.resolveItems({items:(r={},r[e]=Object(d.__assign)(Object(d.__assign)({},qe.e.pack({itemKeys:c})),Je.e.pack(!0)),r)}),{itemResolver:o}};return{onProcessResponse:function(e){var n,a,i,r,o,s=e.driveItemKey,c=e.item;if(c&&s){var l=c.remoteItem,u=l&&l.shared&&(null!==(n=l.shared.sharedBy)&&void 0!==n?n:l.shared.owner),f=(null===(a=null==u?void 0:u.user)||void 0===a?void 0:a.displayName)||(Ze?"":(null===(i=null==u?void 0:u.user)||void 0===i?void 0:i.email)||Qe.s),p=Object(d.__assign)(Object(d.__assign)({},null!==(r=null==u?void 0:u.user)&&void 0!==r?r:{}),{displayName:f}),m=Ne.e.serialize(s);if(!Ze||p.email||p.id){var _=Ve.serialize({displayName:p.displayName,email:p.email||"",id:p.id||""});o=_,t.hasOwnProperty(o)||(t[_]=[]),t[_].push(m)}}},groupChildItems:n}}(e);if(t===le.a[le.e])return function(e){var t={},n=function(a){for(var i,r,o=new Ke.e({publisher:n}),s=function(e){for(var t={},n=function(e){for(var t=[],n=0,a=e;n<a.length;n++){var i=a[n];if(!ze.matches(i))return e;var r=ze.deserialize(i);t.push(r)}return t.sort(function(e,t){return e&&t&&new Date(t.sharedDateTime).getTime()-new Date(e.sharedDateTime).getTime()}).map(function(e){return ze.serialize(e)})}(Object.keys(e)),a=function(e){return t.hasOwnProperty(e)},i=0,r=n;i<r.length;i++){var o=r[i];if(ze.matches(o)){var s=ze.deserialize(o).relativeTime,c=Ge.serialize({relativeTime:s});if(a(c))for(var d=0,l=e[o];d<l.length;d++){var u=l[d];t[c].push(u)}else{t[c]=[];for(var f=0,p=e[o];f<p.length;f++)u=p[f],t[c].push(u)}}}return t}(t),c=[],l=0,u=Object.keys(s);l<u.length;l++){var f=u[l];if(Ge.matches(f)){var p=Ge.deserialize(f).relativeTime;o.resolveItems({items:(i={},i[f]=Object(d.__assign)(Object(d.__assign)(Object(d.__assign)({},O.u.pack(p)),We.r.pack(!0)),qe.e.pack({itemKeys:s[f]})),i)}),c.push(f)}}return o.resolveItems({items:(r={},r[e]=Object(d.__assign)(Object(d.__assign)({},qe.e.pack({itemKeys:c})),Je.e.pack(!0)),r)}),{itemResolver:o}};return{onProcessResponse:function(e){var n,a=e.driveItemKey,i=e.item;if(i&&a){var r=i.remoteItem,o=r&&r.shared&&r.shared.sharedDateTime,s=Ne.e.serialize(a);if(o){var c=function(e,t){if(!e)return Qe.n;var n=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=n)return Ye.today;if(n.setDate(n.getDate()-1),e>=n)return Ye.yesterday;if(n.setDate(t.getDate()-t.getDay()),e>=n)return Qe.i;if(n.setDate(n.getDate()-7),e>n)return Qe.t;var a=new Date(t.getFullYear(),t.getMonth(),1);if(e>=new Date(t.getFullYear(),t.getMonth()-1,1)&&e<a)return Qe.e;if(n.setDate(n.getDate()-7),e>n)return Qe.o;if(n.setDate(n.getDate()-7),e>n)return Qe.r;if(e>=a)return Qe.a;var i=t.getFullYear()===e.getFullYear(),r=Xe.e[e.getMonth()];return i?r:j.format(Ye.MonthAndYear,r,e.getFullYear())}(new Date(o),new Date),d=ze.serialize({relativeTime:c,sharedDateTime:o});n=d,t.hasOwnProperty(n)||(t[d]=[]),t[d].push(s)}}},groupChildItems:n}}(e)}return{onProcessResponse:void 0,groupChildItems:void 0}}(t.itemKey),s=n.onProcessResponse,c=n.groupChildItems,l=U.e.deserialize(t.itemKey),u=l.driveItemKey.endpoint,f=a(Object(Re.e)({graphSharedWithMeEndpoint:He.x})).graphSharedWithMeEndpoint,u=f||u,F.e.isActivated("C8633E26-C16D-4D6D-ABE5-BE1A2C3C256A","02/23/2022","Use OneDrive endpoint for Shared with me")?[3,3]:f&&f!==l.driveItemKey.endpoint?(l=Object(d.__assign)(Object(d.__assign)({},l),{driveItemKey:Object(d.__assign)(Object(d.__assign)({},l.driveItemKey),{endpoint:f})}),[3,3]):[3,1];case 1:return[4,a(Object($e.e)({endpoint:u}))];case 2:(p=b.sent())!==l.driveItemKey.endpoint&&(l=Object(d.__assign)(Object(d.__assign)({},l),{driveItemKey:Object(d.__assign)(Object(d.__assign)({},l.driveItemKey),{endpoint:p})})),b.label=3;case 3:return(m=a(Object(fe.i)(l.driveItemKey.endpoint)))&&!r&&(r=le.s,o=!0),_=U.e.serialize(l),[4,a(Object(xe.e)(Object(d.__assign)(Object(d.__assign)({},t),{qosName:"sharedWithMe",itemKey:_,itemSetKeyFacet:U.e,parentItemKeyFacet:re.e,disableRemoteItem:!1,getUrl:function(e){var t=e.driveItemKey.endpoint;return m?"".concat(t,"/drive/oneDrive.sharedWithMe?select=*,webDavUrl"):!F.e.isActivated("211F049A-DF94-41B3-99C3-E71620C63E23","05/31/2022","Remove me from request Url")&&p?"".concat(t,"/drive/sharedWithMe?expand=formats&allowExternal=true&$top=500"):"".concat(t,"/me/drive/sharedWithMe?expand=formats&allowExternal=true&$top=500")},filterChildItems:function(e){return!function(e,t){return void 0===t&&(t=[]),t.every(function(t){var n,a=!("sharedByName"===t.type)||function(e,t){var n,a,i,r=(null===(n=e.remoteItem)||void 0===n?void 0:n.shared)&&(null!==(a=e.remoteItem.shared.sharedBy)&&void 0!==a?a:e.remoteItem.shared.owner),o=null===(i=null==r?void 0:r.user)||void 0===i?void 0:i.displayName;return!!o&&t.indexOf(o)>-1}(e,t.values),i=!("fileName"===t.type)||function(e,t){return!!e.name&&function(e,t){var n,a,i=(n=e,a=Object(Oe.t)(n,!0),Object(we.n)(a)),r=ke.get(i);return!!r&&Object(Ce.t)(t.filters,r)}(e.name,t)}(e,Object(Ee.t)(t.values)),r=!("dateModified"===t.type)||function(e,t){var n=e.lastModifiedDateTime||"";return(n&&new Date(n))>=t}(e,function(e){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(e){case Le.e.today:return n;case Le.e.yesterday:return Ae(n,1);case Le.e.last7Days:return Ae(n,7);case Le.e.last30Days:return Ae(n,30);case Le.e.last3Months:return Ae(n,90);default:return new Date(0)}}((n=t.values).length<1||-1===Object.keys(Le.e).indexOf(n[0])?Le.e.none:Le.e[n[0]]));return a&&i&&r})}(e,i)},sortChildItems:function(e){return function(e,t,n,a){void 0===a&&(a=!1);var i=le.a[le.e],r=le.a[le.u],o=le.a[ue.a],s=le.a[ue.n],c=le.a[le.d],d=le.a[ue.s];switch(t){case i:return Fe(e,n,a,Pe);case r:return Fe(e,n,a,Ue);case o:case s:case d:return Fe(e,n,a,Te);case c:return Fe(e,n,a,Me);default:return e}}(e,r,o,!0)},onProcessResponse:s,groupChildItems:c,mapItemSetKey:function(){var n,a=new Ke.e({publisher:e});return a.mapKeys({mappings:(n={},n[_]=t.itemKey,n)}),{itemResolver:a}},scenarioInfo:{scenario:et.e.PopulateSharedWithMe,scenarioType:et.t.ActiveUserOperation}})))];case 4:return h=b.sent().itemResolver,a(h.execute()),[2]}})})}}),nt=n(215),at=n(399),it=n(3040),rt=Object(i.t)(function(){return function(e){e(Object(nt.t)({keyFacet:U.e,facets:[U.e,qe.e]})),e(Ie.e),e(Object(r.a)(U.e,at.e)(tt)),e(it.e)}}),ot=n(619),st=n(2779),ct=n(493),dt=n(604),lt=n(2912),ut=n(129),ft=n(387),pt=n(1040),mt=n(37),_t=n(204),ht=F.t.isActivated("d4cb8ed6-56a5-4c23-8c49-2f352054edd9","12/15/2021","Use cultureName instead of cultureUIName to display the date"),bt=Object(ut.i)({name:lt.e,key:le.e,fieldName:"",minWidth:ut.e.regularMin,maxWidth:ut.e.regularMax,isCollapsable:!0,sortProps:ut.t},pt.e)(function(e,t){var n=e.demandItemFacet(ft.e,t),a=n&&new Date(n.sharedDateTime).getTime();if("number"!=typeof a||isNaN(a))return{text:""};var i=e.demandItemFacet(mt.O,_t.e),r=!ht&&(null==i?void 0:i.cultureLCID)||(null==i?void 0:i.language)||window.navigator.language;return r?{text:Object(dt.n)(new Date(a),r)}:{dateValue:a}}),gt=n(1268),vt=n(267),yt=n(1367),St=n(910),Dt=new Be.e("topCollaboratorSetKeyFacet",{endpoint:je.e}),It=n(1530),xt=n(533),Ct=n(1686),Ot=n(3694),wt=n(18);Object(wt.n)([{rawString:".topCollaPlaceHolder_f0c2bf25{display:flex;min-width:13px;height:21px}[dir=ltr] .topCollaPlaceHolder_f0c2bf25{padding-right:10px}[dir=rtl] .topCollaPlaceHolder_f0c2bf25{padding-left:10px}.topCollaboratorIcon_f0c2bf25{color:#0078d4;font-size:13px;line-height:21px;text-align:center}.topCollaboratorUserName_f0c2bf25{font-weight:700}.topCollaboratorTooltip_f0c2bf25{padding:0 2px}.userWithTopCollaborator_f0c2bf25{display:flex}.userWithTopCollaborator_f0c2bf25 .topCollaPlaceHolder_f0c2bf25{min-width:13px}[dir=ltr] .userWithTopCollaborator_f0c2bf25 .topCollaPlaceHolder_f0c2bf25{padding-right:7px}[dir=rtl] .userWithTopCollaborator_f0c2bf25 .topCollaPlaceHolder_f0c2bf25{padding-left:7px}[dir=ltr] .columnHeader_f0c2bf25{margin-left:20px}[dir=rtl] .columnHeader_f0c2bf25{margin-right:20px}"}]);var Et=function(e){function t(t){return e.call(this,t)||this}return Object(d.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.userName,n=e.isPlaceholder,a=b.createElement(xt.e,{className:"topCollaboratorIcon_f0c2bf25",iconName:"TeamFavorite"}),i=b.createElement("span",{className:"topCollaboratorUserName_f0c2bf25"},t),r=b.createElement("div",{className:"topCollaboratorTooltip_f0c2bf25"},j.formatToArray(Ot.e,i));return b.createElement("div",{className:"topCollaPlaceHolder_f0c2bf25"},n?null:t?b.createElement(Ct.e,{content:r},a):a)},t}(It.e),At=Object(ut.i)({name:lt.a,key:le.u,fieldName:"",minWidth:ut.e.regularMin,maxWidth:ut.e.regularMax,isCollapsable:!0,sortProps:ut.a,headerClassName:"columnHeader_f0c2bf25"},gt.e)(function(e,t){var n,a=e.demandItem({shareByPerson:yt.e},t).shareByPerson,i=e.demandItem({sharedBy:ft.e},t).sharedBy,r=null==a?void 0:a.itemKey,o=i&&(null!==(n=i.sharedBy)&&void 0!==n?n:i.owner),s=(null==a?void 0:a.displayValue)||o&&o.user&&o.user.displayName,c=!1;if(r&&St.e.matches(r)){var d=St.e.deserialize(r).email,l=e.demandItemFacet(qe.e,Dt.serialize({endpoint:"https://graph.microsoft.com/beta"}));l&&(c=l.itemKeys.slice(0,3).some(function(t){var n=e.demandItemFacet(vt.e,t);return!!n&&n===d}))}return r||s?{people:[{itemKey:r||"",displayValue:s}],onRenderUser:function(e,t){if(!e||!t)return null;var n=t(e),a=e.user;return b.createElement("div",{className:"userWithTopCollaborator_f0c2bf25"},b.createElement(Et,{userName:a.title,isPlaceholder:!c}),n)}}:{people:[]}},function(e,t){return"".concat(e.demandItemFacet(vt.e,t))}),Lt=!F.e.isActivated("261491DC-B6D7-4FB8-85F3-EBAA7EA472B0","05/31/2022",'Enables the "Shared Date" column in ODC Shared with me');function kt(e,t){var n=t.itemSetKey,a=!1,i=e.demandItemFacet(U.e,n);if(i){var r=i.driveItemKey.endpoint;a=Object(fe.a)(e,r)}return{columns:Object(d.__spreadArray)(Object(d.__spreadArray)([],a?Object(d.__spreadArray)([ot.e,ct.t],Lt?[bt]:[],!0):[ot.t,st.e,bt],!0),[At],!1)}}var Mt=n(360),Pt=new Be.e("topCollaboratorItemKeyFacet",{id:je.e}),Tt=Object(i.i)()(function e(t){var n=this,a=t.itemKey;return function(i){return Object(d.__awaiter)(n,void 0,void 0,function(){var n,r,o,s,c,l,u,f,p,m,_,h,b,g,v,y;return Object(d.__generator)(this,function(S){switch(S.label){case 0:return n=new Ke.e({publisher:e}),r=i(Object(Re.e)({graphEndpoint:He.v})).graphEndpoint,o=Dt.deserialize(a),s=r||o.endpoint,c="".concat(s,"/me/people/"),[4,i(Object(fe.t)({url:c,qosName:"getTopCollaborator",endpoint:s}))];case 1:for(l=S.sent(),u=[],f=0,p=l.value;f<p.length;f++)m=p[f],_=m.id,h=m.displayName,b=m.userPrincipalName,g=Pt.serialize({id:_}),i(Object(nt.e)({items:(v={},v[g]=Object(d.__assign)(Object(d.__assign)({},O.u.pack(h)),vt.e.pack(b)),v)})),u.push(g);return n.resolveItems({items:(y={},y[t.itemKey]=Object(d.__assign)({},qe.e.pack({itemKeys:u})),y)}),i(n.execute()),[2]}})})}});function Ut(e,t){return{isAvailable:!1}}function Ft(e,t){return{isAvailable:!1}}var Ht=Object(i.t)(function(){return function(e){e(rt),e(Object(c.e)(re.e,o.e)(se)),e(Object(c.e)(re.e,s.e)(ie)),e(Object(c.e)(U.e,de.t)(me)),e(Object(c.e)(U.e,he.e)(ve)),e(Object(c.e)(U.e,be.e)(Se)),e(Object(c.e)(U.e,be.t)(De)),e(Object(c.e)(U.e,Mt.e)(kt)),e(Object(c.e)(Ve,he.e)(Ut)),e(Object(c.e)(Ge,he.e)(Ft)),e(Object(r.a)(Dt,at.e)(Tt))}})}}]);